{% extends 'base.html' %}
{% block content %}
{% load static %}



<!-- class="row fixed-top " -->
<!-- style=" position: fixed;" -->
<style>
    .dark-select {
    background-color: #333;
    color: #fff;
    width: 200px;
}
</style>
<!-- <section > -->
    <div class="fixed-top" style="top: 7rem; margin-left: 18rem;" >
     
          <div style="height: 600px;overflow-y: scroll;">
             <h3  class="mb-3  text-white " style="font-size: 2rem;">EditProject</h3><br>     
      
            <form  method="post" action="{% url 'editprojdb' proj.id %}"  enctype="multipart/form-data" class="">
              {% csrf_token %}
              
              
              <div class=" form-group row">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label >Project name*</label>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <input  type="text" class="form-control" name="name" value="{{proj.name}}" required>     
                        <div class="invalid-feedback">Please fill out this field.</div>   
 
                </div>
                
            </div>

               <div class="form-group row mt-4">
                   <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Description</label></div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input type="text" class="form-control" name="desc"  value="{{proj.desc}}" required>     
                        <div class="invalid-feedback">Please fill out this field.</div>   
 
                    </div>


                </div>
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Customer Name*</label></div>
                     <div class="col-sm-12 col-md-6 col-lg-6">
                        
                        <select name="c_name" id=""   class="form-control">
                            
                            <option value="">Select Customer</option>
  

    {% for c in data %}
    {% if c.id == proj.c_name.id %}
    <option value="{{c.id}}"selected>{{c.customerName}}</option>
    {% else %}
    <option value="{{c.id}}">{{c.customerName}}</option>
    {% endif %}
    {% endfor %}


                        </select>
                              
                     </div>
                     
 
                 </div>

                 <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Billing Method*</label></div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <select name="billing" id="billingMethodSelect" class="form-control"  >
                            

                            <option value="Fixed cost for project">Fixed cost for project</option>
                            <option value="Based on project hours">Based on project hours</option>
                            <option value="Based on staff hours">Based on staff hours</option>
                            <option value="Based on task hours">Based on task hours</option>



                        </select>
                    </div>
                </div>
                <div id="inputBoxContainer" >
                    <div class=" form-group row">
                        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                            <label >Rate per hour*</label>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-6">
                            <input  type="text" class="form-control" name="rateperhour"  id="inputBox"  value="{{proj.rateperhour}}">     
                                
         
                        </div>
                        
                    </div>
                    
                </div>
                    <center>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                         <input  type="checkbox"  name="w_phone" placeholder="work phone" required>
                            
                         <label class="col-sm-12 col-md-6 col-lg-6 ">Add budget for this project.</label>
                     </div>
                    </center>
 
                    <label for="">Users</label><br>
    <table class="table text-black" id="user_table">
        <thead>
            <tr>
                <th>User</th>
                <th class="text-right">E-mail</th>
                <th class="text-center">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr id="user_row1">
                <td>
                    <input type="text" class="form-control" id="user1" name="usern" value="{{proj.usern}}">
                </td>
                <td class="text-right">
                    <input type="email" class="form-control" id="email1" name="email" value="{{proj.email}}">
                </td>
                <td class="text-center">
                    <button type="button" class="btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row" style="width:30px">
                        <i class="fa fa-times"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30);" id="add-user-row">Add another line</button><br><br><br>

    <label for="">Tasks</label><br>
    <table class="table text-black" id="task_table">
        <thead>
            <tr>
                <th>Task name</th>
                <th class="text-right">Description</th>
                
                <th class="text-center">Actions</th>

            </tr>
        </thead>
        <tbody>
            <tr id="task_row1">
                <td>
                    <input type="text" class="form-control" id="task1" name="taskn" value="{{proj.taskn}}">
                </td>
                <td class="text-right">
                    <input type="text" class="form-control" id="desc1" name="taskdesc" value="{{proj.taskdesc}}">
                </td>
                
                <td class="text-center">
                    <button type="button" class="btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row" style="width:30px">
                        <i class="fa fa-times"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30);" id="add-task-row">Add another line</button><br><br>
    <div class="col-sm-12 col-md-6 col-lg-6">
        <input  type="checkbox"  name="w_phone" placeholder="work phone" required>
           
        <label class="col-sm-12 col-md-6 col-lg-6 ">Add to the watchlist on my dashboard.</label>
    </div>
    <button type="submit" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30);" id="save-btn">Save</button>
    <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30);" id="cancel-btn">Cancel</button>
    <script>
        document.getElementById('cancel-btn').addEventListener('click', function() {
          // Clear input fields when cancel button is clicked
          var inputFields = document.querySelectorAll('input[type="text"]');
          for (var i = 0; i < inputFields.length; i++) {
            inputFields[i].value = '';
          }
        });
      </script>
    






                    <script>
                        var userRowCounter = 1;
                        var taskRowCounter = 1;
                
                        // Add row function for the user table
                        function addUserRow() {
                            userRowCounter++;
                
                            var newRow = '<tr id="user_row' + userRowCounter + '">' +
                                '<td><input type="text" class="form-control"  id="user'  + userRowCounter + '"></td>' +
                                '<td class="text-right"><input type="email" class="form-control"  id="email' + userRowCounter + '"></td>' +
                                '<td class="text-center">' +
                                '<button type="button" class="btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row" style="width:30px">' +
                                '<i class="fa fa-times"></i></button></td>' +
                                '</tr>';
                
                            $('#user_table tbody').append(newRow);
                        }
                
                        // Add row function for the task table
                        function addTaskRow() {
                            taskRowCounter++;
                
                            var newRow = '<tr id="task_row' + taskRowCounter + '">' +
                                '<td><input type="text" class="form-control"  id="task' + taskRowCounter + '"></td>' +
                                '<td class="text-right"><input type="text" class="form-control"  id="desc' + taskRowCounter + '"></td>' +
                                '<td class="text-right"><input type="text" class="form-control"  id="desc' + taskRowCounter + '"></td>' +
                                '<td class="text-center">' +
                                '<button type="button" class="btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row" style="width:30px">' +
                                '<i class="fa fa-times"></i></button></td>' +
                                '</tr>';
                
                            $('#task_table tbody').append(newRow);
                        }
                
                        // Event listener for Add User Row button
                        $('#add-user-row').on('click', function () {
                            addUserRow();
                        });
                
                        // Event listener for Add Task Row button
                        $('#add-task-row').on('click', function () {
                            addTaskRow();
                        });
                
                        // Event delegation for delete row functionality
                        $(document).on('click', '.delete-row', function () {
                            $(this).closest('tr').remove();
                        });
                    </script>


<script>
    function gstPan_function(){
        var x=document.getElementById('GSTT').value
        if(x=="Unregistered Business-not Registered under GST")
        {
            document.getElementById("pan").style.display="block";
            document.getElementById("gst").style.display="none";

            
        }
        else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
        {
            document.getElementById("gst").style.display="block";
            document.getElementById("pan").style.display="block";


        }
    
    }
    function gst_check(){
        var x=document.getElementById("gst_input").value;
        var gst_label=document.getElementById("gst_label")
        // var expr=/^[0-9]{15}$/;
        var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;

        // "[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}"
        // /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/
        if (!expr.test(x)) {
            gst_label.style.color="red";
            gst_label.innerHTML = "Invalid GST Number.";
        }
        else{
            gst_label.style.color="green";

            gst_label.innerHTML = "valid GST Number.";

        }
    }
    function pan_check(){
        var x=document.getElementById("pan_input").value;
        var gst_label=document.getElementById("pan_label")
        var expr=    /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
        if (!expr.test(x)) {
            pan_label.style.color="red";
            pan_label.innerHTML = "Invalid PAN Number.";
        }
        else{
            pan_label.style.color="green";

            pan_label.innerHTML = "valid PAN Number.";

        }
    }
 

    $(document).ready(function () {
        $(".toggle1").click(function (e) {
          e.preventDefault();
          $("fieldset1").toggle();
        })
      })
      $(document).ready(function () {
        $(".toggle2").click(function (e) {
          e.preventDefault();
          $("fieldset2").toggle();
        //   $("fieldset5").toggle();
        //   $("fieldset6").toggle();


        })
      })
      $(document).ready(function () {
        $(".toggle3").click(function (e) {
          e.preventDefault();
          $("fieldset5").toggle();

        })
      })
      $(document).ready(function () {
        $(".toggle4").click(function (e) {
          e.preventDefault();
          $("fieldset6").toggle();
         

         
        })
      })
      $(document).ready(function () {
        $(".toggle7").click(function (e) {
          e.preventDefault();
          $("fieldset7").toggle();
         

         
        })
      })

      $('document').ready(function () {
        $('.add_another').click(function () {
          $("#tbl").append('<tr><td><select name="salutation[]" id="PLACE" style="width:8rem;height: 2.4rem;"><option value="Mr" selected>Mr.</option><option value=""Mrs">Mrs.</option><option value="Ms">Ms.</option><option value="Miss">Miss.</option><option value="Dr">Dr.</option></select>  </td><td><input type="text" name="first_name[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="last_name[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="email[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="wphone[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="mobile[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="skype[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="designation[]" style="width:8rem;" class="txtbox" value="" /></td><td><input type="text" name="department[]" style="width:8rem;" class="txtbox" value="" /></td></tr>');
        });
      })

      function fieldset5_function()
      {
        document.getElementById("address").style.display="block";
      }

      function myCopyAddressFunction() {
        var checkBox = document.getElementById("myCheckT");
        var textatn = document.getElementById("batten");
        var txtcry = document.getElementById("bctry");
        var txtadrs11 = document.getElementById("badd1");
        var txtcty = document.getElementById("bcty");
        var txtstat = document.getElementById("bste");
        var txtzip = document.getElementById("bzp");
        var txtphone = document.getElementById("bphn");
        var txtfx = document.getElementById("bfx");
  
        var textatn1 = document.getElementById("satten");
        var txtcry1 = document.getElementById("sctry");
        var txtadrs21 = document.getElementById("sadd1");
        var txtcty1 = document.getElementById("scty");
        var txtstat1 = document.getElementById("sste");
        var txtzip1 = document.getElementById("szp");
        var txtphone1 = document.getElementById("sphn");
        var txtfx1 = document.getElementById("sfx");
        if (checkBox.checked == true) {
          txtadrs21.value = txtadrs11.value;
          txtcty1.value = txtcty.value;
          txtstat1.value = txtstat.value;
          txtzip1.value = txtzip.value;
          txtphone1.value = txtphone.value;
          txtfx1.value = txtfx.value;

          textatn1.value = textatn.value;
          
  
        } else {
          txtadrs21.value = "";
          txtcty1.value = "";
          txtstat1.value = "";
          txtzip1.value = "";
          txtphone1.value = "";
          txtfx1.value = "";
          txtcry1.value = "";
          textatn1.value = "";

  
        }
      }

      function open_table()
      {
        document.getElementById("hid").style.display="block";
        
      }
      

     
</script>

<script>

    // set todays date on estimate date field
    var today = new Date().toISOString().substr(0, 10);
    document.getElementById("estimate_date").value = today;
    document.getElementById("expiry_date").value = today;

    // Add new row
    $(document).ready(function () {
        $('#add-row').click(function () {
            var table = document.getElementById("item_table");
            var RowCount = table.rows.length;
            console.log(RowCount);
            var newRow = $(`
            <tr id='row${RowCount}' >
               
                <td ><input type='text' id='user${RowCount}'
                        >
                </td>
                <td class='text-right'><input type='email' id='email${RowCount}'
                       
                        ></td>
                
                <td class='text-center'><button type='button' id='del_btn${RowCount}'
                        class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                        style='width:30px'><i class='fa fa-times'></i></button></td>
            </tr>`);
            $('#item_table').append(newRow);
        });

        $('#item_table').on('click', '.delete-row', function () {
            $(this).closest('tr').remove();
            calc();
        });

    });





</script>


{% endblock %}